---
title: 童話「おおかみと7ひきのこやぎ」から学ぶ。ログイン画面のセキュリティー対策
tags:
  - Security
  - Web
  - 脆弱性
  - 初学者向け
private: false
updated_at: '2022-10-11T09:34:28+09:00'
id: 9a63c529921706293445
organization_url_name: null
slide: false
ignorePublish: false
---
童話「おおかみと7ひきのこやぎ」を娘に読み聞かせていたら、この話から読み取れる教訓がログイン画面のセキュリティー対策にも役立ちそうだと思ったので記事にすることにしました。

# 童話「おおかみと7ひきのこやぎ」とは

グリム童話の1つであり、かなりメジャーな話なのでご存知の方が多いと思いますが、最初にこの記事で肝となる部分をおさらいします。
画像には「[いらすとや](https://www.irasutoya.com/)」の素材をたくさん使わせていただきました！ありがとうございます :pray: 

話はお母さんやぎが出かけて7匹の子やぎだけで留守番するところから始まります。
![スクリーンショット 2022-10-07 0.01.45.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/83424/1c5b441c-eb71-4b57-8416-d669e3e7ecc7.png)
そこへオオカミがお母さんヤギのふりをしてやってきました。
![スクリーンショット 2022-10-07 0.20.24.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/83424/2b8fb838-6196-4c72-00b2-dc1c7e2402a1.png)
オオカミは声を綺麗にするためにチョークを飲み込んで...
![スクリーンショット 2022-10-07 0.19.45.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/83424/3fcb7de9-abc7-2097-f99e-6ce62f683a53.png)
オオカミは白い粉で足を白くして...
![スクリーンショット 2022-10-07 0.26.52.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/83424/03e71e73-0458-a254-d42b-c539c8d64fdb.png)
こうして子やぎたちはドアをあけてしまい、オオカミに食べられてしまいます。

## どうすればよかったのか？

様々な対策があるとは思いますが、オオカミが突破できた理由の1つは子やぎたちがオオカミだと気づいた理由を開示してしまったことだと思います。
次のようにただ「ドアはあけません」とだけしか言わなければオオカミは何を改善すれば良いかわからずに詰んでいたと思います。
![スクリーンショット 2022-10-07 0.34.26.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/83424/1cbd7b4c-f1b7-c3fb-5a97-0215591de55e.png)
![スクリーンショット 2022-10-07 0.36.51.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/83424/d027f3dc-b67a-fb53-980e-8ec5700637e5.png)

# ログイン画面にあてはめる

この話をログイン画面に当てはめてみます。

それっぽい情報を入力...
![スクリーンショット 2022-10-07 0.45.05.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/83424/c4b9dd17-a5e2-7b25-9792-70f9c3f90ead.png)
メールアドレスを変えて次々にトライ...
![スクリーンショット 2022-10-07 0.50.59.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/83424/ead536af-06e5-b268-6cb0-7278b4f0dd1a.png)
「メールアドレスが存在しません」が消えたのでメールアドレスはあっているぽい！!
あとはパスワードだけを変えて試せば良いので成功率が格段に上がります。
また、たとえログインされなかったとしても`fuga@example.com`というメールアドレスのユーザーが存在することが漏れてしまうので良くありません。

## どうすればよかったのか？

こちらもエラーメッセージでヒントを出しているのが問題なので、ヒントにならないメッセージに変えましょう。

![スクリーンショット 2022-10-07 1.00.20.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/83424/d6dad690-bf01-4910-0889-247200f7268a.png)

これであれば、メールアドレスが間違っているのかパスワードが間違っているのか、それとも両方が間違っているのかわかりません。

# まとめ

Webアプリケーションのベストプラクティスを学んでいると、入力フォームではユーザーが迷わないように丁寧にエラー原因を伝えましょう！と書かれていることが多いです。
そのノリでログイン画面を作ると、この記事に書いたようにエラー原因を詳細に伝えてしまうことがあります。
ログイン画面やパスワードリセット画面などアプリケーションの入口となる部分では悪意のあるユーザーがログイン情報を盗もうとしている可能性を踏まえて、ヒントを与えないエラーメッセージを心がけるようにしましょう。
